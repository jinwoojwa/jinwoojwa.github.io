---
title: "[OS] UNIX/Linux File System"
excerpt: "Operating Systems, Internals and Design Principles μ •λ¦¬"

categories:
  - Operating System
tags:
  - [Operating System]

permalink: /operating-system/os-file-system3/

toc: true
toc_sticky: true
use_math: true

date: 2024-06-05
last_modified_at: 2024-06-05
published: true
---

> William Stallingsμ γ€Operating Systems, Internals and Design Principles (9th Ed.)γ€ μ„ ν† λ€λ΅ μ‘μ„±ν•μ€μ. <br>

<br>

# π‘‘ UNIX File System

`UNIX File System`μ—μ„λ” λ‹¤μμ μ—¬μ„― κ°€μ§€ μΆ…λ¥λ΅ νμΌμ„ κµ¬λ¶„ν•λ‹¤.

- **Regular (or Ordinary) file**

- **Directory**

- **Special file**

- **Named pipes**

- **Links**

- **Symbolic links**

<br>

## π’΅ Inode

UNIX λ° UNIX κ³„μ—΄ μ΄μ μ²΄μ μ—μ„ `inode(μΈλ±μ¤ λ…Έλ“)`λ” νμΌμ— λ€ν• λ©”νƒ€λ°μ΄ν„°λ¥Ό μ €μ¥ν•λ” λ°μ΄ν„° <br>

κµ¬μ΅°μ΄λ‹¤. νμΌ μ‹μ¤ν…μ κ° νμΌμ€ inodeκ³Ό μ—°κ²°λμ–΄ μμΌλ©°, ν•΄λ‹Ή νμΌμ— λ€ν• μ¤‘μ”ν• μ •λ³΄λ¥Ό ν¬ν•¨ν•λ‹¤. <br>

`inode`μ— λ€ν• μ£Όμ” λ‚΄μ©μ€ λ‹¤μκ³Ό κ°™λ‹¤.

- **κ³ μ  μ‹λ³„μ**

    + κ° `inode`λ” νμΌ μ‹μ¤ν… λ‚΄μ—μ„ `inode λ²νΈ(μΈλ±μ¤ λ²νΈ)`λ΅ κ³ μ ν•κ² μ‹λ³„λλ‹¤. <br>
      μ΄ λ²νΈλ” μ΄μ μ²΄μ κ°€ inodeμ™€ μ—°κ²°λ νμΌμ„ μ°Ύκ³  κ΄€λ¦¬ν•λ” λ° μ‚¬μ©λλ‹¤.

- **λ©”νƒ€λ°μ΄ν„°**

    inodeμ€ νμΌμ— λ€ν• λ©”νƒ€λ°μ΄ν„°λ¥Ό μ €μ¥ν•λ©°, μ΄λ” λ‹¤μμ„ ν¬ν•¨ν•λ‹¤.

    + νμΌ μ ν• (μΌλ° νμΌ, λ””λ ‰ν† λ¦¬, μ‹¬λ³Όλ¦­ λ§ν¬ λ“±μ„ κµ¬λ¶„)

    + νμΌ μ†μ μ, κ·Έλ£Ή λ° κΈ°νƒ€ μ‚¬μ©μμ— λ€ν• κ¶ν•(μ½κΈ°, μ“°κΈ°, μ‹¤ν–‰)

    + νƒ€μ„μ¤νƒ¬ν”„(μƒμ„± μ‹κ°„, μµκ·Ό μ ‘κ·Ό μ‹κ°„, μµκ·Ό μμ • μ‹κ°„)

    + νμΌ ν¬κΈ°(λ°”μ΄νΈ λ‹¨μ„)

    + νμΌμ μ‹¤μ  λ‚΄μ©μ„ μ €μ¥ν•λ” λ””μ¤ν¬μ λ°μ΄ν„° λΈ”λ΅μ— λ€ν• ν¬μΈν„°

    + `Link Count` : ν•΄λ‹Ή `inode`μ— λ€ν• λ§ν¬μ μλ¥Ό λ‚νƒ€λ‚΄λ” κ°’ <br>
      μ‰½κ² λ§ν•λ©΄, `λ‡ κ°μ λ””λ ‰ν† λ¦¬μ—μ„ μ΄ νμΌμ„ κ°€λ¦¬ν‚¤κ³  μλ”μ§€`λ¥Ό μ•λ ¤μ¤

- **λ°μ΄ν„° λΈ”λ΅μ— λ€ν• ν¬μΈν„°**

    + inodeμ—λ” μΌλ°μ μΌλ΅ νμΌ λ‚΄μ©μ΄ μ €μ¥λ λ””μ¤ν¬μ λ°μ΄ν„° λΈ”λ΅μ— λ€ν• ν¬μΈν„°κ°€ ν¬ν•¨λμ–΄ μλ‹¤.

    + μ΄λ¬ν• ν¬μΈν„°λ” νμΌ ν¬κΈ° λ° νμΌμ„ μ €μ¥ν•λ” λ° ν•„μ”ν• λ°μ΄ν„° λΈ”λ΅μ μ–‘μ— λ”°λΌ <br>
      μ§μ ‘ ν¬μΈν„°, λ‹¨μΌ κ°„μ ‘ ν¬μΈν„°, μ΄μ¤‘ κ°„μ ‘ ν¬μΈν„° λλ” μ‚Όμ¤‘ κ°„μ ‘ ν¬μΈν„°μΌ μ μλ‹¤.

- **Inode ν…μ΄λΈ”**

    + νμΌ μ‹μ¤ν…μ€ νμΌ μ‹μ¤ν… λ‚΄ λ¨λ“  νμΌμ inodeλ¥Ό ν¬ν•¨ν•λ” `inode table (or list)`μ„ <br>
      κ°€μ§€λ©°, νμΌμ— μ•΅μ„Έμ¤ν•  λ• ν•΄λ‹Ήν•λ” inodeκ°€ λ©”λ¨λ¦¬λ΅ λ΅λ“λμ–΄ νμΌ μ‘μ—…μ— μ‚¬μ©λλ‹¤.

<br>

## π’΅ UNIX File Allocation

 UNIX μ‹μ¤ν…μ€ `Indexed allocation` λ°©μ‹μ„ μ‚¬μ©ν•μ—¬, νμΌμ„ λΈ”λ΅ λ‹¨μ„λ΅ ν• λ‹Ήν•λ‹¤. <br>
 
 νμΌμ λΈ”λ΅μ€ μ—°μ†μ μ΄μ§€ μ•μ„ μ μμΌλ©°, νμΌ ν• λ‹Ή λ°©μ‹μ€ κ° νμΌμ `inode`μ— μ €μ¥λμ–΄ μλ‹¤. <br><br>

 μΌλ°μ μΌλ΅ UNIX μ‹μ¤ν…μ—μ„λ” λ‹¤μκ³Ό κ°™μ€ λ°©μ‹μΌλ΅ νμΌ ν• λ‹Ήμ΄ μ΄λ£¨μ–΄μ§„λ‹¤.

 - **Direct Pointers**

    + λ¨λ“  UNIX μ‹μ¤ν… κµ¬ν„μ—μ„λ” inodeμ— `μ§μ ‘ ν¬μΈν„°(direct pointers)`κ°€ ν¬ν•¨λμ–΄ μλ‹¤. <br>
    
    + μ§μ ‘ ν¬μΈν„°λ” νμΌμ μ²μ λ‡ κ° λΈ”λ΅μ„ μ§μ ‘ κ°€λ¦¬ν‚¤λ” ν¬μΈν„°λ΅, μΌλ°μ μΌλ΅ 12κ°μ΄λ‹¤. <br>
    
    + μ΄λ” μ‘μ€ νμΌμ κ²½μ°μ—λ” νμΌ λ°μ΄ν„° λΈ”λ΅μ„ μ§μ ‘ κ°€λ¦¬ν‚¤λ” λ° μ‚¬μ©λλ‹¤.

- **Indirect Pointers**

    νμΌμ΄ λ” λ§μ€ λΈ”λ΅μ„ ν•„μ”λ΅ ν•λ” κ²½μ°, inodeμ—λ” `κ°„μ ‘ ν¬μΈν„°(indirect pointers)`κ°€ <br>
    ν¬ν•¨λλ‹¤. κ°„μ ‘ ν¬μΈν„°λ” μ¶”κ°€μ μΈ λΈ”λ΅μ„ κ°€λ¦¬ν‚¤λ” ν¬μΈν„°λ΅, μ„Έ κ°€μ§€ μ ν•μ΄ μλ‹¤. <br><br>
      
    + **Single Indirect Pointer**

        * `Inode`μ ν¬μΈν„°κ°€ `Single Indirect Pointer`μ„ κ°€λ¦¬ν‚¤λ©°, ν•΄λ‹Ή λΈ”λ΅μ€ <br>
          λ°μ΄ν„° λΈ”λ΅μ„ κ°€λ¦¬ν‚¨λ‹¤.

    + **Double Indirect Pointer**

        * `Inode`μ ν¬μΈν„°κ°€ `Double Indirect Pointer`λ¥Ό κ°€λ¦¬ν‚¤λ©°, ν•΄λ‹Ή λΈ”λ΅μ€ λ‹¤μ‹ <br>
          `Single Indirect Pointer`λ¥Ό κ°€λ¦¬ν‚¤κ³ , μ΄λ” λ°μ΄ν„° λΈ”λ΅μ„ κ°€λ¦¬ν‚¨λ‹¤.

    + **Triple Indirect Pointer**

        * `Inode`μ ν¬μΈν„°κ°€ `Triple Indirect Pointer`λ¥Ό κ°€λ¦¬ν‚¤λ©°, ν•΄λ‹Ή λΈ”λ΅μ€ <br>
          `Double Indirect Pointer -> Single Indirect Pointer -> data` μ κ²½λ΅λ¥Ό κ°€μ§„λ‹¤.
          
<center><img src="https://github.com/jinwoojwa/jinwoo.github.io/assets/112393728/0b66d117-fee9-4615-af97-3f0fdbc29ec4" width="600"></center>

<br>

# π‘‘ Linux Virtual File System

`Virtual File System(VFS)`μ€ μ‚¬μ©μκ°€ νμΌ μ‹μ¤ν…μ— κ΄€κ³„ μ—†μ΄ κ³µν†µλ μΈν„°νμ΄μ¤λ΅ <br>

νμΌ μ‹μ¤ν…μ— μ ‘κ·Όν•  μ μλ„λ΅ ν•λ” κ³„μΈµμ„ μλ―Έν•λ‹¤. λ””μ¤ν¬λ§λ‹¤ λ‹¤λ¥Έ νμΌ μ‹μ¤ν…μ„ κ°€μ§€κ³  <br>

μλ”λΌλ„ `VFS`κ°€ μ„Έλ¶€ μ‚¬ν•­μ„ μ¶”μƒν™”ν•μ—¬ `open, read, write, close`κ³Ό κ°™μ€ `system call`μ„ <br>

ν†µν•΄ λ‘κ°™μ΄ μ²λ¦¬ν•  μ μλ„λ΅ ν•λ‹¤. μ΄λ¬ν• `VFS`μ μ—­ν•  λ•λ¶„μ— Linuxλ” λ‹¤μ–‘ν• νμΌ μ‹μ¤ν…μ„ μ§€μ›ν•λ©°, <br>

μ‚¬μ©μμ™€ μ‘μ© ν”„λ΅κ·Έλ¨μ΄ νμΌ μ‹μ¤ν…μ μ°¨μ΄λ¥Ό μ‹ κ²½ μ“°μ§€ μ•κ³  νμΌ μ‘μ—…μ„ μν–‰ν•  μ μκ² λλ‹¤.

<center><img src="https://github.com/jinwoojwa/jinwoo.github.io/assets/112393728/7c14ef2e-8686-418b-bf06-7536f6608f93" width="500"></center>



